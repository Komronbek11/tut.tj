<!DOCTYPE html><html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Таблица расчета экзаменов</title>
    <style>
    body {
        width: 100%;
  margin: 0;
  padding: 0;
  font-family: Arial, sans-serif;
        background-color: black;
        color: white;
}

/* Для мобильных устройств */
@media (max-width: 768px) {
  body {
    font-size: 14px;
    background-color: ;
  }
}

/* Для планшетов */
@media (min-width: 769px) and (max-width: 1024px) {
  body {
    font-size: 16px;
    background-color: #e0e0e0;
  }
}

/* Для больших экранов */
@media (min-width: 1025px) {
  body {
    font-size: 18px;
    background-color: #ffffff;
  }
}
    .table-container {
  width: 100%;
  overflow-x: auto; /* Горизонтальная прокрутка на маленьких экранах */
}

table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
    border-radius: 10px;
  border: 1px solid #ddd;
  padding: 8px;
  text-align: center;
}

@media (max-width: 768px) {
  th, td {
      background-color: black;
      color: white;
    font-size: 14px;
    padding: 6px;
  }
}
    
        table {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
        }
        th, td {
            border: 1px solid none;
            padding: 8px;
        }
        input {
            border-radius: 10px;
            width: 90px;
            height: 30px;
            text-align: center;
        }
    button{
        
          height: 40px;
          border-radius: 20px;
        border: none;
          background-color: #216bff;
          color: white;
    margin-top: 15px;
        display: absolute;
        margin: 10px;
    }
    .container{
        display: block;
        width: ;
        align-items: center;
        margin: 10px;
        paddind-top: 30px;
    }
     .add{
    width: 140px;
    height: 40px;
    border-radius: 20px;
    border: none;
    background-color: #216bff;
    color: white;
  }
   .save{
    width: 140px;
    height: 40px;
    border-radius: 20px;
    border: none;
    background-color: green;
    color: white;
  }
   .export{
    width: 140px;
    height: 40px;
    border-radius: 20px;
    border: none;
    background-color: #ff5c21;
    color: white;
     margin: 5px;
  }
     .back{
         padding: 2px;
    width: 35px;
    height: 35px;
    border-radius: 50%;
  }
    </style>
</head>
<body>
     <img onclick="goBack()"  class="back"src="back.jpg"><br>
           
    <h2>Таблица расчета экзаменов</h2>
    <div class="container">
         <button class="save" onclick="saveData()">Сохранить данные</button>
        <br>
    <button class="export" onclick="exportToExcel()">Экспорт в Excel</button>
   
    <button class="add" onclick="addRow()">Добавить предмет</button>
    
    </div>
    <table id="examTable">
        <thead>
            <tr>
                <th>Фан</th>
                <th>P1</th>
                <th>P2</th>
                <th>Имтиҳон</th>
                <th>Холи умӯми ретингҳо	 </th>
                <th>Холи умӯми имтиҳонҳо</th>
                <th>Ҷамъи ҳолҳо</th>
                <th>Баҳо</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table><script>
    function goBack() {
      window.location.href = "home.html";
    }
    
const subjects = ["Фани дарсӣ-ро интихоб кунед", "База данных", "Политология", "Этика и эстетика", "Статистика и КОД", "Усул ва ВХИ", "Програм. на Java"];
    
    function addRow() {
        let table = document.getElementById('examTable').getElementsByTagName('tbody')[0];
        let newRow = table.insertRow();
        
        let subjectCell = newRow.insertCell(0);
        let p1Cell = newRow.insertCell(1);
        let p2Cell = newRow.insertCell(2);
        let examCell = newRow.insertCell(3);
        let results1Cell = newRow.insertCell(4);
        let results2Cell = newRow.insertCell(5);
        let totalCell = newRow.insertCell(6);
        let gradeCell = newRow.insertCell(7);
        
        let select = document.createElement("select");
        subjects.forEach(subject => {
            let option = document.createElement("option");
            option.value = subject;
            option.textContent = subject;
            select.appendChild(option);
        });
        subjectCell.appendChild(select);
        
        p1Cell.innerHTML = `<input type="number" step="any" oninput="calculateResults(this)">`;
        p2Cell.innerHTML = `<input type="number" step="any" oninput="calculateResults(this)">`;
        examCell.innerHTML = `<input type="number" step="any" oninput="calculateResults(this)">`;
        results1Cell.textContent = "0";
        results2Cell.textContent = "0";
        totalCell.textContent = "0";
        gradeCell.textContent = "-";
    }

    function calculateResults(input) {
        let row = input.parentElement.parentElement;
        let p1 = parseFloat(row.cells[1].getElementsByTagName('input')[0].value) || 0;
        let p2 = parseFloat(row.cells[2].getElementsByTagName('input')[0].value) || 0;
        let exam = parseFloat(row.cells[3].getElementsByTagName('input')[0].value) || 0;
        
        let results1 = ((p1 + p2) / 2) * 0.6;
        let results2 = exam * 0.4;
        let total = results1 + results2;
        
        row.cells[4].textContent = results1.toFixed(2);
        row.cells[5].textContent = results2.toFixed(2);
        row.cells[6].textContent = total.toFixed(2);
        row.cells[7].textContent = getGrade(total);
    }

    function getGrade(score) {
        if (score >= 95) return "A"+"(5)";
        if (score >= 90) return "A-"+"(-5)";
        if (score >= 85) return "B+";
        if (score >= 80) return "B";
        if (score >= 75) return "B-";
        if (score >= 70) return "C+";
        if (score >= 65) return "C";
        if (score >= 60) return "C";
        if (score >= 55) return "D+";
        if (score >= 50) return "D";
        if (score >= 25) return "E";
        return "F";
    }

    function saveData() {
        let tableData = [];
        let rows = document.querySelectorAll("#examTable tbody tr");
        rows.forEach(row => {
            let rowData = {
                subject: row.cells[0].querySelector("select").value,
                p1: row.cells[1].querySelector("input").value,
                p2: row.cells[2].querySelector("input").value,
                exam: row.cells[3].querySelector("input").value,
                total: row.cells[6].textContent,
                grade: row.cells[7].textContent
            };
            tableData.push(rowData);
        });
        localStorage.setItem("examData", JSON.stringify(tableData));
    }

    function loadData() {
        let savedData = localStorage.getItem("examData");
        if (savedData) {
            JSON.parse(savedData).forEach(data => {
                addRow();
                let lastRow = document.querySelector("#examTable tbody tr:last-child");
                lastRow.cells[0].querySelector("select").value = data.subject;
                lastRow.cells[1].querySelector("input").value = data.p1;
                lastRow.cells[2].querySelector("input").value = data.p2;
                lastRow.cells[3].querySelector("input").value = data.exam;
                lastRow.cells[6].textContent = data.total;
                lastRow.cells[7].textContent = data.grade;
            });
        }
    }

    function exportToExcel() {
        let table = document.getElementById("examTable");
        let wb = XLSX.utils.table_to_book(table, {sheet:"Экзамены"});
        XLSX.writeFile(wb, "exam_results.xlsx");
    }

    document.addEventListener("DOMContentLoaded", loadData);
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

</body>
</html>